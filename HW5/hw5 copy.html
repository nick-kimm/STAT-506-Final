<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nick Kim">

<title>HW5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw5_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw5_files/libs/quarto-html/quarto.js"></script>
<script src="hw5_files/libs/quarto-html/popper.min.js"></script>
<script src="hw5_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw5_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw5_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw5_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw5_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="hw5_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="hw5_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="hw5_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="hw5_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="hw5_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="hw5_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="hw5_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="hw5_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="hw5_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">HW5</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nick Kim </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Link to my <a href="%22www.github.com/nick-kimm/STAT-506%22">github</a> repository</p>
<section id="problem-1" class="level2">
<h2 class="anchored" data-anchor-id="problem-1">Problem 1</h2>
<p>Creating a class to represent rational numbers</p>
<p>#part a:</p>
<p>Setting constructor and Validity</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Rational class</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'Defining a class object that'll take in two integer inputs, one for the numerator and one for the denominator. This will be used to return a rational number given the input.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return rational number</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setClass</span>(<span class="st">"rational"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">slots =</span> <span class="fu">c</span>(<span class="at">numerator =</span> <span class="st">"numeric"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">denominator =</span> <span class="st">"numeric"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>rational <span class="ot">&lt;-</span> <span class="cf">function</span>(n, d) {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (d <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Denominator cannot be zero."</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new</span>(<span class="st">"rational"</span>, <span class="at">numerator =</span> n, <span class="at">denominator =</span> d)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">setValidity</span>(<span class="st">"rational"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(object){</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (object<span class="sc">@</span>denominator <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>(<span class="st">"Denominator can't be zero"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>              <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Class "rational" [in ".GlobalEnv"]

Slots:
                              
Name:    numerator denominator
Class:     numeric     numeric</code></pre>
</div>
</div>
<p>Show method</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setMethod</span>(<span class="st">"show"</span>,<span class="st">"rational"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(object) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">"Numerator :"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str</span>(object<span class="sc">@</span>numerator)  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">"Denominator :"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str</span>(object<span class="sc">@</span>denominator)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="fu">invisible</span>(object))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Simplify method</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Greatest Common Divisor</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'Will find the greatest common divisor for the given numerator and denominator values in the "rational" object. The function will use the Euclidean method, which is a recursive solution to get the gcd. This algorithm will continiously take the mod of the numbers until the remainder is zero, where a will store the value of previous operation. </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param a,b </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return integer of the gcd</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>gcd<span class="ot">&lt;-</span><span class="cf">function</span>(a,b){</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (b <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">abs</span>(a))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">gcd</span>(b,a<span class="sc">%%</span>b))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simplify</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#'Will reduce the rational down to its simplified form. This will be found by dividing the numerator by the gcd of the numerator and denominator and similarly for the denominator.</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param object </span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return simplified rational of the input</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">setGeneric</span>(<span class="st">"simplify"</span>,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>           <span class="cf">function</span>(object){</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>             n<span class="ot">&lt;-</span>object<span class="sc">@</span>numerator<span class="sc">/</span><span class="fu">gcd</span>(object<span class="sc">@</span>numerator,object<span class="sc">@</span>denominator)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>             d<span class="ot">&lt;-</span>object<span class="sc">@</span>denominator<span class="sc">/</span><span class="fu">gcd</span>(object<span class="sc">@</span>numerator,object<span class="sc">@</span>denominator)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">return</span>(<span class="fu">paste</span>(n,<span class="st">"/"</span>,d, <span class="at">sep=</span><span class="st">""</span>))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>           }</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "simplify"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Quotient</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' Will return the quotient of the rational number to a specified digit place. The default digit length will be set at 6.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param object </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param digits </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return Quotient of rational to a specified digit place</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setGeneric</span>(<span class="st">"quotient"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>           <span class="cf">function</span>(object, <span class="at">digits=</span><span class="dv">6</span>){</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> (<span class="fu">is.numeric</span>(digits)<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">return</span>(<span class="st">"Digit is not a numeric value"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>             }<span class="cf">else</span>{</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>               q<span class="ot">&lt;-</span>object<span class="sc">@</span>numerator<span class="sc">/</span>object<span class="sc">@</span>denominator</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>               <span class="fu">return</span>(<span class="fu">print</span>(q,<span class="at">digits=</span>digits))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>           })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "quotient"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Rational Addition</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' Will make sure the input are both in the rational class and then return the added value of the two. This will be done by finding the least common multiple and letting that be our denominator. Then we'd multiply the numerator by the lcm divided by the denominator then add the two new numerator values together. Will then reduce the value down to its simplest form</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param e1 rational. </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param e2 rational. </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return Added value of the two  rational numbers</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setMethod</span>(<span class="st">"+"</span>, <span class="fu">signature</span>(<span class="at">e1 =</span> <span class="st">"rational"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">e2 =</span> <span class="st">"rational"</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(e1,e2){</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>            lcm <span class="ot">&lt;-</span> <span class="fu">abs</span>(e1<span class="sc">@</span>denominator)<span class="sc">*</span>(e2<span class="sc">@</span>denominator<span class="sc">/</span><span class="fu">gcd</span>(e1<span class="sc">@</span>denominator,e2<span class="sc">@</span>denominator))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            new_numerator <span class="ot">&lt;-</span> (lcm<span class="sc">/</span>e1<span class="sc">@</span>denominator)<span class="sc">*</span>e1<span class="sc">@</span>numerator <span class="sc">+</span> (lcm<span class="sc">/</span>e2<span class="sc">@</span>denominator)<span class="sc">*</span>e2<span class="sc">@</span>numerator</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            new_denominator <span class="ot">&lt;-</span> lcm</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            newnum <span class="ot">&lt;-</span> <span class="fu">rational</span>(new_numerator,new_denominator)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="fu">simplify</span>(newnum))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>          })</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#'Rational Subtraction </span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#'Will make sure the input are both in the rational class and then return the subtracted value of the two. This will be done by finding the least common multiple and letting that be our denominator. Then we'd multiply the numerator by the lcm divided by the denominator of then subtract the two new numerator values together. Will then reduce the value down to its simplest form</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param e1 rational. </span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param e2 rational. </span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return Subtracted value of the two rational numbers</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="fu">setMethod</span>(<span class="st">"-"</span>, <span class="fu">signature</span>(<span class="at">e1 =</span> <span class="st">"rational"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">e2 =</span> <span class="st">"rational"</span>),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(e1,e2){</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>            lcm <span class="ot">&lt;-</span> <span class="fu">abs</span>(e1<span class="sc">@</span>denominator)<span class="sc">*</span>(e2<span class="sc">@</span>denominator<span class="sc">/</span><span class="fu">gcd</span>(e1<span class="sc">@</span>denominator,e2<span class="sc">@</span>denominator))</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            new_numerator <span class="ot">&lt;-</span> (lcm<span class="sc">/</span>e1<span class="sc">@</span>denominator)<span class="sc">*</span>e1<span class="sc">@</span>numerator <span class="sc">-</span> (lcm<span class="sc">/</span>e2<span class="sc">@</span>denominator)<span class="sc">*</span>e2<span class="sc">@</span>numerator</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>            new_denominator <span class="ot">&lt;-</span> lcm</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>            newnum <span class="ot">&lt;-</span> <span class="fu">rational</span>(new_numerator,new_denominator)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="fu">simplify</span>(newnum))</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>          })</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#' Rational Multiplication</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">#' Will make sure the input are both in the rational class and then return the multiplied value of the two. This will be done by calling a new rational where the numerator is the multiplied value of the numerators and the denominator is found in the same fashion. Will then reduce the value down to its simplest form</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param e1 rational. </span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param e2 rational. </span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return Multiplied rational of two rationals</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="fu">setMethod</span>(<span class="st">"*"</span>, <span class="fu">signature</span>(<span class="at">e1 =</span> <span class="st">"rational"</span>,</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>                         <span class="at">e2 =</span> <span class="st">"rational"</span>),</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(e1,e2){</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>            newnum <span class="ot">&lt;-</span> <span class="fu">rational</span>(e1<span class="sc">@</span>numerator <span class="sc">*</span> e2<span class="sc">@</span>numerator, e1<span class="sc">@</span>denominator <span class="sc">*</span> e2<span class="sc">@</span>denominator)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="fu">simplify</span>(newnum))</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>          })</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="co">#' Rational Division</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co">#' Will make sure the input are both in the rational class and then return the divided value of the two. Since division of rationals is just multiplication of the reciprocal of one of the rationals the value will be found by multipliying the numerator of one with denominator of the other and vice versa. Will then reduce the value down to its simplest form</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param e1 rational. </span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param e2 rational. </span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return Divided rational of the two</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="fu">setMethod</span>(<span class="st">"/"</span>, <span class="fu">signature</span>(<span class="at">e1 =</span> <span class="st">"rational"</span>,</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>                         <span class="at">e2 =</span> <span class="st">"rational"</span>),</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(e1,e2){</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>            newnum <span class="ot">&lt;-</span> <span class="fu">rational</span>(e1<span class="sc">@</span>numerator <span class="sc">*</span> e2<span class="sc">@</span>denominator, e1<span class="sc">@</span>denominator <span class="sc">*</span> e2<span class="sc">@</span>numerator)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="fu">simplify</span>(newnum))</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>          })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#part b:</p>
<p>Setting up class objects</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rational</span>(<span class="dv">24</span>,<span class="dv">6</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">rational</span>(<span class="dv">7</span>,<span class="dv">230</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>r3 <span class="ot">&lt;-</span> <span class="fu">rational</span>(<span class="dv">0</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(r1<span class="sc">@</span>denominator)<span class="sc">*</span>(r2<span class="sc">@</span>denominator<span class="sc">/</span><span class="fu">gcd</span>(r1<span class="sc">@</span>denominator,r2<span class="sc">@</span>denominator))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 690</code></pre>
</div>
</div>
<p>Checking code in hw</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>r1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Numerator : num 24

Denominator : num 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>r3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Numerator : num 0

Denominator : num 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="sc">+</span> r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "927/230"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="sc">-</span> r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "913/230"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="sc">*</span> r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "14/115"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="sc">/</span> r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "920/7"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="sc">+</span> r3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "4/1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="sc">*</span> r3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0/1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="sc">/</span> r3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in rational(e1@numerator * e2@denominator, e1@denominator * e2@numerator): Denominator cannot be zero.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quotient</span>(r1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quotient</span>(r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0304348</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quotient</span>(r2, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0304</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quotient</span>(r2, <span class="at">digits =</span> <span class="fl">3.14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0304</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quotient</span>(r2, <span class="at">digits =</span> <span class="st">"avocado"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Digit is not a numeric value"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>q2 <span class="ot">&lt;-</span> <span class="fu">quotient</span>(r2, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0304</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>q2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03043478</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quotient</span>(r3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simplify</span>(r1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "4/1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simplify</span>(r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "7/230"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simplify</span>(r3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0/1"</code></pre>
</div>
</div>
<p>#part c:</p>
<p>Checking if validator works, not allowing denominator to be zero and other edge cases</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rational</span>(<span class="dv">40</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in rational(40, 0): Denominator cannot be zero.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rational</span>(<span class="st">"t"</span>,<span class="st">"s"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in validObject(.Object): invalid class "rational" object: 1: invalid object for slot "numerator" in class "rational": got class "character", should be or extend class "numeric"
invalid class "rational" object: 2: invalid object for slot "denominator" in class "rational": got class "character", should be or extend class "numeric"</code></pre>
</div>
</div>
<p>##Problem 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>art <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/nicholaskim/Documents/STAT 506/HW4/df_for_ml_improved_new_market.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#part a: Does the distribution of genre of sales change over the years?</p>
<p>First creating a singly column vector thatâ€™ll store the genre information rather than split amoungst 5. Will also manually assign artworks that overlap in both painting and other to be assigned to only painting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>art<span class="sc">$</span>Genre___Others[art<span class="sc">$</span>Genre___Painting <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>art<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="st">"Photography"</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>art<span class="sc">$</span>genre[art<span class="sc">$</span>Genre___Print <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Print"</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>art<span class="sc">$</span>genre[art<span class="sc">$</span>Genre___Sculpture <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Sculpture"</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>art<span class="sc">$</span>genre[art<span class="sc">$</span>Genre___Painting <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Painting"</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>art<span class="sc">$</span>genre[art<span class="sc">$</span>Genre___Others <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Other"</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(art<span class="sc">$</span>genre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Other    Painting Photography       Print   Sculpture 
         27         519        1746         414        1641 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>yeargenre <span class="ot">&lt;-</span> <span class="fu">with</span>(art, <span class="fu">table</span>(year, genre))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>prop_art <span class="ot">&lt;-</span> yeargenre<span class="sc">/</span><span class="fu">apply</span>(yeargenre,<span class="dv">1</span>,sum)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>prop_art <span class="ot">&lt;-</span> prop_art[, <span class="fu">c</span>(<span class="st">"Painting"</span>, <span class="st">"Sculpture"</span>, <span class="st">"Photography"</span>, <span class="st">"Print"</span>, <span class="st">"Other"</span>)]</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x=</span><span class="sc">~</span>year, <span class="at">y=</span><span class="sc">~</span>Freq<span class="sc">*</span><span class="dv">100</span>, <span class="at">color=</span><span class="sc">~</span>genre,<span class="at">data=</span><span class="fu">data.frame</span>(prop_art),<span class="at">type=</span><span class="st">"bar"</span>)<span class="sc">|&gt;</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Percentage (%)'</span>),<span class="at">barmode =</span> <span class="st">"stack"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a6cd7ff63bc4af0a2d07" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a6cd7ff63bc4af0a2d07">{"x":{"visdat":{"486752f29826":["function () ","plotlyVisDat"]},"cur_data":"486752f29826","attrs":{"486752f29826":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage (%)"},"barmode":"stack","xaxis":{"domain":[0,1],"automargin":true,"title":"year","type":"category","categoryorder":"array","categoryarray":["1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012"]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012"],"y":[50,41.666666666666671,26.666666666666668,17.592592592592592,16.071428571428573,11.458333333333332,7.1428571428571423,12.23404255319149,10.596026490066226,14.467005076142131,11.779448621553884,7.5980392156862742,9.9273607748184016,10.218978102189782,13.249651324965134,12.216404886561955],"type":"bar","name":"Painting","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012"],"y":[31.25,33.333333333333329,16.666666666666664,49.074074074074076,33.035714285714285,30.208333333333332,41.666666666666671,38.297872340425535,40.397350993377486,32.741116751269033,36.591478696741852,37.5,36.077481840193705,34.793187347931877,40.306834030683405,41.012216404886566],"type":"bar","name":"Sculpture","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012"],"y":[18.75,25,56.666666666666664,31.481481481481481,44.642857142857146,52.083333333333336,43.452380952380956,45.744680851063826,40.397350993377486,41.878172588832484,39.598997493734331,40.686274509803923,39.951573849878933,44.768856447688563,34.449093444909344,38.917975567190226],"type":"bar","name":"Photography","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012"],"y":[0,0,0,1.8518518518518516,6.25,6.25,7.7380952380952381,3.7234042553191489,8.6092715231788084,10.913705583756345,10.776942355889723,13.23529411764706,13.317191283292978,9.002433090024331,11.157601115760112,7.1553228621291449],"type":"bar","name":"Print","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012"],"y":[0,0,0,0,0,0,0,0,0,0,1.2531328320802004,0.98039215686274506,0.72639225181598066,1.2165450121654502,0.83682008368200833,0.69808027923211169],"type":"bar","name":"Other","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>From the plot above there seems to be a decrease in the proportion of paintings with a rise in photography and print.</p>
<p>#part b: Is there a change in the sales price in USD over time? How does the genre affect the change in sales price over time?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>save <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1997</span><span class="sc">:</span><span class="dv">2012</span>){</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  price_yr <span class="ot">&lt;-</span> art[art<span class="sc">$</span>year<span class="sc">==</span>i,<span class="st">"price_usd"</span>]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  save[[index]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> i,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">price =</span> price_yr[price_yr <span class="sc">&gt;</span> <span class="fu">quantile</span>(price_yr,.<span class="dv">95</span>)])</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">=</span> index <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>top_price <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, save)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>artmedian <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(art<span class="sc">$</span>price_usd, <span class="at">by =</span> <span class="fu">list</span>(art<span class="sc">$</span>year),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">FUN =</span> median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(artmedian) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"price"</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>overall<span class="ot">&lt;-</span><span class="fu">plot_ly</span>(<span class="at">data =</span> top_price, <span class="at">x =</span> <span class="sc">~</span>year, <span class="at">y =</span> <span class="sc">~</span>price, <span class="at">type =</span> <span class="st">"box"</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Boxplot"</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> artmedian, <span class="at">x =</span> <span class="sc">~</span>year, <span class="at">y =</span> <span class="sc">~</span>price, <span class="at">name =</span> <span class="st">"Median"</span>,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">hovertemplate =</span> <span class="fu">paste</span>(</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>              <span class="st">'&lt;b&gt;Year&lt;/b&gt;: %{x}&lt;br&gt;'</span>,</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>              <span class="st">'&lt;b&gt;Median Price&lt;/b&gt;: $%{y:.2f}&lt;br&gt;'</span>,</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>              <span class="st">'&lt;extra&gt;&lt;/extra&gt;'</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>            )) <span class="sc">|&gt;</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top 5% of Sales Price of Art over the Years"</span>,</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>),</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price (USD)"</span>)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>overall</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-4bef26dd1bf0ea2a6d10" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4bef26dd1bf0ea2a6d10">{"x":{"visdat":{"48672786fe93":["function () ","plotlyVisDat"],"4867fb3792b":["function () ","data"]},"cur_data":"4867fb3792b","attrs":{"48672786fe93":{"x":{},"y":{},"name":"Boxplot","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"},"4867fb3792b":{"x":{},"y":{},"name":"Median","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines","hovertemplate":"<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Top 5% of Sales Price of Art over the Years","xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Price (USD)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(31,119,180,0.5)","x":[1997,1998,1999,1999,2000,2000,2000,2000,2000,2000,2001,2001,2001,2001,2001,2001,2002,2002,2002,2002,2002,2003,2003,2003,2003,2003,2003,2003,2003,2003,2004,2004,2004,2004,2004,2004,2004,2004,2004,2004,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012],"y":[17173,26754,30000,36196,36072,30915,33000,23065,34884,62016,30552,27020,71275,51670,25835,24282,40599,55176,47819,45186,47592,52591,41492,136332,82985,42000,120000,38460,58140,54224,108972,135185,110709,147612,77039,88712,184554,212608,86495,69799,182526,67975,62939,96299,205439,239640,59910,72090,154679,88477,117970,71969,232200,258000,83850,105780,139910,110458,361200,219300,193500,232200,116100,120545,203024,1395790,444115,372650,513000,186277,231300,122075,205600,121090,144782,233029,336575,161556,141235,168137,161412,326047,465367,481000,157000,205000,157000,241000,147860,247876,132136,618244,183600,190944,220320,258983,247490,265000,200953,216337,185569,199080,636363,417722,434541,217467,202254,194475,169593,216922,267362,300610,699576,244652,282425,204245,167574,203856,134160,128500,110940,141260,296646,124308,211890,185487,237244,152267,141013,166405,184844,409211,112417,145393,187362,126420,134160,127688,287642,376933,213493,589405,213493,172592,188048,233232,194819,221021,162326,148404,249095,264738,154766,189158,169962,169962,248919,160947,146873,165036,137530,125930,156770,141460,465532,110596,119242,138033,118235,127293,711364,231954,214198,136165,114536,314974,118220,141350,173622,110423,416850,235335,243416,170694,143221,377412,377412,107774,102640,133432,110851,193401,137381,131222,140855,144749,158364,163962,196755,377113,122015,306720,428899,283812,459444,122747,122747,355201,211578,226624,143873,144384,129764,734650,247901,181256,220376,228200,156803,125702,156803,124189,171698,187219],"name":"Boxplot","type":"box","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[5812,4916,7088.5,4340.5,3590.5,6047,7025,7775,8429.5,9556.5,11089,16235.5,12903,13329,11507,11136],"name":"Median","type":"scatter","mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>","<b>Year<\/b>: %{x}<br> <b>Median Price<\/b>: $%{y:.2f}<br> <extra><\/extra>"],"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>artmedian <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(art<span class="sc">$</span>price_usd, <span class="at">by =</span> <span class="fu">list</span>(art<span class="sc">$</span>year, art<span class="sc">$</span>genre),</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">FUN =</span> median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(artmedian) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"genre"</span>, <span class="st">"price"</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>art975 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(art<span class="sc">$</span>price_usd, <span class="at">by =</span> <span class="fu">list</span>(art<span class="sc">$</span>year, art<span class="sc">$</span>genre),</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">FUN =</span> quantile, .<span class="dv">975</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(art975) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"genre"</span>, <span class="st">"price"</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>artmedian<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="fu">factor</span>(artmedian<span class="sc">$</span>genre, <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(artmedian<span class="sc">$</span>genre)))</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>art975<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="fu">factor</span>(art975<span class="sc">$</span>genre, <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(art975<span class="sc">$</span>genre)))</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>artcombine <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  artmedian <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"Median"</span>),</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  art975 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"97.5%"</span>)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>bygenre<span class="ot">&lt;-</span><span class="fu">plot_ly</span>(<span class="at">x=</span><span class="sc">~</span>year,<span class="at">y=</span><span class="sc">~</span>price,<span class="at">data =</span> artcombine,<span class="at">color=</span><span class="sc">~</span>genre,<span class="at">type=</span><span class="st">"scatter"</span>,<span class="at">mode=</span><span class="st">"lines"</span>,<span class="at">linetype =</span> <span class="sc">~</span>measure,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">hovertemplate =</span> <span class="fu">paste</span>(</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>              <span class="st">'&lt;b&gt;Year&lt;/b&gt;: %{x}&lt;br&gt;'</span>,</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>              <span class="st">'&lt;b&gt;Price&lt;/b&gt;: $%{y}&lt;br&gt;'</span>))<span class="sc">|&gt;</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title=</span><span class="st">"Change in Art Price over the Years by Genre"</span>,</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis=</span><span class="fu">list</span>(<span class="at">title=</span><span class="st">"Price (USD)"</span>),</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis=</span><span class="fu">list</span>(<span class="at">title=</span><span class="st">"Year"</span>))</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>bygenre</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e0c48839b040dcf4e2c1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e0c48839b040dcf4e2c1">{"x":{"visdat":{"48676d6b85e9":["function () ","plotlyVisDat"]},"cur_data":"48676d6b85e9","attrs":{"48676d6b85e9":{"x":{},"y":{},"mode":"lines","hovertemplate":"<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","color":{},"linetype":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Change in Art Price over the Years by Genre","yaxis":{"domain":[0,1],"automargin":true,"title":"Price (USD)"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2007,2008,2009,2010,2011,2012],"y":[14963.700000000001,36019.799999999996,20357.400000000001,13661.800000000001,9761.75,10307.599999999999],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Other<br />97.5%","line":{"color":"rgba(166,216,84,1)","dash":"solid"},"marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2007,2008,2009,2010,2011,2012],"y":[6609,8242,7179,9160,5795.5,7520.5],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Other<br />Median","line":{"color":"rgba(166,216,84,1)","dash":"dash"},"marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[16063.325000000001,8106.5000000000018,15051.300000000001,34689.599999999999,21548.799999999985,20661,42847.524999999987,66719,68532.749999999869,69557.400000000067,70955.050000000076,201049.25,126420,45026.175000000003,76005.999999999825,77905.574999999852],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Painting<br />97.5%","line":{"color":"rgba(231,138,195,1)","dash":"solid"},"marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[5614,4604,4650,4367,4259.5,4490,5922,5346,5966,6362,7315,13563,9084,13804,8408,8585],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Painting<br />Median","line":{"color":"rgba(231,138,195,1)","dash":"dash"},"marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[12879.75,19840.25,33717.600000000013,36357.674999999916,26403.949999999993,47767.925000000003,66072.800000000192,142999.125,96103.449999999953,348382.90000000072,222386.69999999969,298336.875,187174.5,232877.6499999995,229290.59999999989,237065.44999999978],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Photography<br />97.5%","line":{"color":"rgba(141,160,203,1)","dash":"solid"},"marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[6605,4683,11250,5324,3762.5,7128,9517,12036.5,12410,25588,23668,22530,19776,22064,23632,19090],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Photography<br />Median","line":{"color":"rgba(141,160,203,1)","dash":"dash"},"marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[7923.7250000000004,47794.749999999985,39286.75,12350.499999999998,117897.04999999996,21746.125,57193.849999999933,202599.9999999998,120727.37499999997,79764.499999999971,63209.000000000131,81053.499999999811,62500],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Print<br />97.5%","line":{"color":"rgba(252,141,98,1)","dash":"solid"},"marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[6474.5,6272,21216,9250,11125,8044.5,6176,8579,19323,13205,13356,10860,13321],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Print<br />Median","line":{"color":"rgba(252,141,98,1)","dash":"dash"},"marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[9418.5,25378.049999999996,22484.100000000002,17522.799999999985,12179.700000000001,15719.5,46438.499999999862,61634.375,104485.12499999971,80398.999999999985,117802.375,81276.999999999942,104600.69999999992,82059.449999999953,110561.39999999999,107479.3000000001],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Sculpture<br />97.5%","line":{"color":"rgba(102,194,165,1)","dash":"solid"},"marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[3640,8153,5520,3306,2669,3546,4881,6201,6668,5859,8136,11699,9055,6098,7633,7599],"mode":"lines","hovertemplate":["<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>","<b>Year<\/b>: %{x}<br> <b>Price<\/b>: $%{y}<br>"],"type":"scatter","name":"Sculpture<br />Median","line":{"color":"rgba(102,194,165,1)","dash":"dash"},"marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>combined_graph <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>() <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">data =</span> top_price, <span class="at">x =</span> <span class="sc">~</span>year, <span class="at">y =</span> <span class="sc">~</span>price, <span class="at">type =</span> <span class="st">"box"</span>,<span class="at">name =</span> <span class="st">"Boxplot"</span>,<span class="at">visible =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x=</span><span class="sc">~</span>year,<span class="at">y=</span><span class="sc">~</span>price,<span class="at">data =</span> artcombine,<span class="at">color=</span><span class="sc">~</span>genre,<span class="at">type=</span><span class="st">"scatter"</span>,<span class="at">mode=</span><span class="st">"lines"</span>,<span class="at">linetype =</span> <span class="sc">~</span>measure, <span class="at">visible =</span> <span class="cn">FALSE</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>combined_graph<span class="sc">|&gt;</span><span class="fu">layout</span>(</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>),</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price (USD)"</span>),</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">updatemenus =</span> <span class="fu">list</span>(</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">list</span>(</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">args =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">visible =</span>  <span class="fu">list</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)),</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Top 5% of Sales Price of Art over the Years"</span>))),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"overall"</span>),</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">args =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">visible =</span>  <span class="fu">list</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)),</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Change in Art Price over the Years by Genre"</span>))),</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"genre"</span>))</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9622fc592aece9bb5118" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9622fc592aece9bb5118">{"x":{"visdat":{"48676dba6d3c":["function () ","plotlyVisDat"],"48676a59b66b":["function () ","data"],"486727d76159":["function () ","data"]},"cur_data":"486727d76159","attrs":{"48676a59b66b":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"box","name":"Boxplot","visible":true,"inherit":true},"486727d76159":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"color":{},"type":"scatter","mode":"lines","linetype":{},"visible":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Price (USD)"},"updatemenus":[{"y":1,"buttons":[{"method":"update","args":[{"visible":[true,false,false,false,false,false,false,false,false,false,false]},{"title":{"title":"Top 5% of Sales Price of Art over the Years"}}],"label":"overall"},{"method":"update","args":[{"visible":[false,true,true,true,true,true,true,true,true,true,true]},{"title":{"title":"Change in Art Price over the Years by Genre"}}],"label":"genre"}]}],"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(31,119,180,0.5)","x":[1997,1998,1999,1999,2000,2000,2000,2000,2000,2000,2001,2001,2001,2001,2001,2001,2002,2002,2002,2002,2002,2003,2003,2003,2003,2003,2003,2003,2003,2003,2004,2004,2004,2004,2004,2004,2004,2004,2004,2004,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2006,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2008,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2009,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2011,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012,2012],"y":[17173,26754,30000,36196,36072,30915,33000,23065,34884,62016,30552,27020,71275,51670,25835,24282,40599,55176,47819,45186,47592,52591,41492,136332,82985,42000,120000,38460,58140,54224,108972,135185,110709,147612,77039,88712,184554,212608,86495,69799,182526,67975,62939,96299,205439,239640,59910,72090,154679,88477,117970,71969,232200,258000,83850,105780,139910,110458,361200,219300,193500,232200,116100,120545,203024,1395790,444115,372650,513000,186277,231300,122075,205600,121090,144782,233029,336575,161556,141235,168137,161412,326047,465367,481000,157000,205000,157000,241000,147860,247876,132136,618244,183600,190944,220320,258983,247490,265000,200953,216337,185569,199080,636363,417722,434541,217467,202254,194475,169593,216922,267362,300610,699576,244652,282425,204245,167574,203856,134160,128500,110940,141260,296646,124308,211890,185487,237244,152267,141013,166405,184844,409211,112417,145393,187362,126420,134160,127688,287642,376933,213493,589405,213493,172592,188048,233232,194819,221021,162326,148404,249095,264738,154766,189158,169962,169962,248919,160947,146873,165036,137530,125930,156770,141460,465532,110596,119242,138033,118235,127293,711364,231954,214198,136165,114536,314974,118220,141350,173622,110423,416850,235335,243416,170694,143221,377412,377412,107774,102640,133432,110851,193401,137381,131222,140855,144749,158364,163962,196755,377113,122015,306720,428899,283812,459444,122747,122747,355201,211578,226624,143873,144384,129764,734650,247901,181256,220376,228200,156803,125702,156803,124189,171698,187219],"type":"box","name":"Boxplot","visible":true,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2007,2008,2009,2010,2011,2012],"y":[14963.700000000001,36019.799999999996,20357.400000000001,13661.800000000001,9761.75,10307.599999999999],"type":"scatter","mode":"lines","visible":false,"name":"Other<br />97.5%","line":{"color":"rgba(166,216,84,1)","dash":"solid"},"marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2007,2008,2009,2010,2011,2012],"y":[6609,8242,7179,9160,5795.5,7520.5],"type":"scatter","mode":"lines","visible":false,"name":"Other<br />Median","line":{"color":"rgba(166,216,84,1)","dash":"dash"},"marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[16063.325000000001,8106.5000000000018,15051.300000000001,34689.599999999999,21548.799999999985,20661,42847.524999999987,66719,68532.749999999869,69557.400000000067,70955.050000000076,201049.25,126420,45026.175000000003,76005.999999999825,77905.574999999852],"type":"scatter","mode":"lines","visible":false,"name":"Painting<br />97.5%","line":{"color":"rgba(231,138,195,1)","dash":"solid"},"marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[5614,4604,4650,4367,4259.5,4490,5922,5346,5966,6362,7315,13563,9084,13804,8408,8585],"type":"scatter","mode":"lines","visible":false,"name":"Painting<br />Median","line":{"color":"rgba(231,138,195,1)","dash":"dash"},"marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[12879.75,19840.25,33717.600000000013,36357.674999999916,26403.949999999993,47767.925000000003,66072.800000000192,142999.125,96103.449999999953,348382.90000000072,222386.69999999969,298336.875,187174.5,232877.6499999995,229290.59999999989,237065.44999999978],"type":"scatter","mode":"lines","visible":false,"name":"Photography<br />97.5%","line":{"color":"rgba(141,160,203,1)","dash":"solid"},"marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[6605,4683,11250,5324,3762.5,7128,9517,12036.5,12410,25588,23668,22530,19776,22064,23632,19090],"type":"scatter","mode":"lines","visible":false,"name":"Photography<br />Median","line":{"color":"rgba(141,160,203,1)","dash":"dash"},"marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[7923.7250000000004,47794.749999999985,39286.75,12350.499999999998,117897.04999999996,21746.125,57193.849999999933,202599.9999999998,120727.37499999997,79764.499999999971,63209.000000000131,81053.499999999811,62500],"type":"scatter","mode":"lines","visible":false,"name":"Print<br />97.5%","line":{"color":"rgba(252,141,98,1)","dash":"solid"},"marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[6474.5,6272,21216,9250,11125,8044.5,6176,8579,19323,13205,13356,10860,13321],"type":"scatter","mode":"lines","visible":false,"name":"Print<br />Median","line":{"color":"rgba(252,141,98,1)","dash":"dash"},"marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[9418.5,25378.049999999996,22484.100000000002,17522.799999999985,12179.700000000001,15719.5,46438.499999999862,61634.375,104485.12499999971,80398.999999999985,117802.375,81276.999999999942,104600.69999999992,82059.449999999953,110561.39999999999,107479.3000000001],"type":"scatter","mode":"lines","visible":false,"name":"Sculpture<br />97.5%","line":{"color":"rgba(102,194,165,1)","dash":"solid"},"marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],"y":[3640,8153,5520,3306,2669,3546,4881,6201,6668,5859,8136,11699,9055,6098,7633,7599],"type":"scatter","mode":"lines","visible":false,"name":"Sculpture<br />Median","line":{"color":"rgba(102,194,165,1)","dash":"dash"},"marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>##Problem 3</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#part a:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>flights <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(nycflights13<span class="sc">::</span>flights)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>airports <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(nycflights13<span class="sc">::</span>airports)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Departures</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>depart<span class="ot">&lt;-</span>flights[,.(<span class="at">med_dep =</span> <span class="fu">median</span>(dep_delay,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">mean_dep =</span> <span class="fu">mean</span>(dep_delay,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">count =</span> .N), by<span class="ot">=</span>origin]<span class="sc">|&gt;</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  _[count<span class="sc">&gt;</span><span class="dv">10</span>,]</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(depart)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"faa"</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(<span class="at">x=</span>depart, airports[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by =</span> <span class="st">"faa"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)<span class="sc">|&gt;</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  _[<span class="fu">order</span>(depart<span class="sc">$</span>mean_dep, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  name med_dep mean_dep  count
                &lt;char&gt;   &lt;num&gt;    &lt;num&gt;  &lt;int&gt;
1: Newark Liberty Intl      -1 15.10795 120835
2:          La Guardia      -3 10.34688 104662
3: John F Kennedy Intl      -1 12.11216 111279</code></pre>
</div>
</div>
<p>Arrivals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>arrival<span class="ot">&lt;-</span>flights[,.(<span class="at">med_dep =</span> <span class="fu">median</span>(arr_delay,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">mean_dep =</span> <span class="fu">mean</span>(arr_delay,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">count =</span> .N), by<span class="ot">=</span>dest]<span class="sc">|&gt;</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  _[count<span class="sc">&gt;</span><span class="dv">10</span>,]</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(arrival)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"faa"</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(<span class="at">x=</span>arrival, airports[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by =</span> <span class="st">"faa"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)<span class="sc">|&gt;</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  _[<span class="fu">order</span>(mean_dep, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          name med_dep   mean_dep count
                        &lt;char&gt;   &lt;num&gt;      &lt;num&gt; &lt;int&gt;
  1:     Columbia Metropolitan    28.0  41.764151   116
  2:                Tulsa Intl    14.0  33.659864   315
  3:         Will Rogers World    16.0  30.619048   346
  4:      Jackson Hole Airport    15.0  28.095238    25
  5:             Mc Ghee Tyson     2.0  24.069204   631
 ---                                                   
 97:       Seattle Tacoma Intl   -11.0  -1.099099  3923
 98:             Honolulu Intl    -7.0  -1.365193   707
 99:                      &lt;NA&gt;    -9.0  -3.835907   522
100: John Wayne Arpt Orange Co   -11.0  -7.868227   825
101:         Palm Springs Intl   -13.5 -12.722222    19</code></pre>
</div>
</div>
<p>#part b: How many flights did the aircraft model with the fastest average speed take?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>planes <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(nycflights13<span class="sc">::</span>planes[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)])</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>combined<span class="ot">&lt;-</span><span class="fu">merge</span>(<span class="at">x=</span>flights, <span class="at">y=</span>planes, <span class="at">by =</span> <span class="st">"tailnum"</span>,<span class="at">all.y=</span><span class="cn">TRUE</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>combined[<span class="sc">!</span><span class="fu">is.na</span>(air_time),.(<span class="at">mph =</span> distance<span class="sc">/</span>(air_time<span class="sc">/</span><span class="dv">60</span>)), by <span class="ot">=</span> model]<span class="sc">|&gt;</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  _[,.(<span class="at">avg_mph =</span> <span class="fu">mean</span>(mph,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">count =</span> .N),by <span class="ot">=</span> model]<span class="sc">|&gt;</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  _[<span class="fu">order</span>(avg_mph, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)]<span class="sc">|&gt;</span>_[<span class="dv">1</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     model  avg_mph count
    &lt;char&gt;    &lt;num&gt; &lt;int&gt;
1: 777-222 482.6254     4</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>